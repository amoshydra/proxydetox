<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js rust">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Proxydetox</title>
        <meta name="robots" content="noindex" />


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "rust";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('rust')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="introduction.html">Introduction</a></li><li class="chapter-item expanded "><a href="installation.html"><strong aria-hidden="true">1.</strong> Installation</a></li><li class="chapter-item expanded "><a href="configuration.html"><strong aria-hidden="true">2.</strong> Configuration</a></li><li class="chapter-item expanded "><a href="usage.html"><strong aria-hidden="true">3.</strong> Usage</a></li><li class="spacer"></li><li class="chapter-item expanded "><a href="build.html"><strong aria-hidden="true">4.</strong> Building Proxydetox</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="service.html"><strong aria-hidden="true">4.1.</strong> Auto start</a></li></ol></li><li class="chapter-item expanded "><a href="cross_compile.html"><strong aria-hidden="true">5.</strong> Cross compiling</a></li><li class="chapter-item expanded "><a href="developers.html"><strong aria-hidden="true">6.</strong> For developers</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><a href="alternatives.html">Alternatives</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Proxydetox</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="introduction-to-proxydetox"><a class="header" href="#introduction-to-proxydetox">Introduction to Proxydetox</a></h1>
<p>A small proxy to relieve the pain of some corporate proxies.</p>
<p>Proxydetox can act as an intermediate HTTP proxy for your local applications and
actual HTTP proxy. Proxydtox will talk to the actual corporate HTTP proxies on
behalf of the actual application. Proxydetox will select the correct upstream
proxy based on the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Proxy_servers_and_tunneling/Proxy_Auto-Configuration_(PAC)_file" title="Proxy Auto-Configuration (PAC) file">Proxy Auto-Configuration (PAC) file</a> provided by the
network administrator and will take care to correctly authenticate against the
upstream proxy.</p>
<p>With Proxydetox in place, most local applications can be configured to use the
proxy by setting the environment variables <code>http_proxy</code>, and <code>https_proxy</code>.</p>
<p>The following authentication methods are supported:</p>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Authentication#basic_authentication_scheme" title="Basic authentication scheme">Basic</a>: use the username and password from <code>~/.netrc</code>.</li>
<li><a href="https://www.rfc-editor.org/rfc/rfc4559.html#section-4" title="HTTP Negotiate Authentication Scheme">Negotiate</a><sup>1,2</sup>: on Linux and macOS it will use
<a href="https://web.mit.edu/kerberos/krb5-devel/doc/appdev/gssapi.html" title="Generic Security Services API (GSSAPI)">GSSAPI</a>, on Windows <a href="https://docs.microsoft.com/en-us/windows/win32/rpc/security-support-provider-interface-sspi-" title="Security Support Provider Interface (SSPI)">SSPI</a> will be used.</li>
</ul>
<p>Proxydetox supports the following systems:</p>
<ul>
<li>POSIX-compliant systems (tested on Ubuntu and OpenBSD)</li>
<li>macOS</li>
<li>Windows</li>
</ul>
<p>Pre build versions of Proxydetox can be found on <a href="https://github.com/kiron1/proxydetox/releases" title="Proxydetox releases">the releases page</a>.
Installation instructions are provided in the
<a href="installation.html">installation section</a>.</p>
<p><sup>1)</sup> Can be disabled via the <code>--no-default-features</code> flag during build
time.<br>
<sup>2)</sup> Can be activated with the <code>--negotiate</code> flag during runtime.</p>
<h2 id="license"><a class="header" href="#license">License</a></h2>
<p>This source code is under the <a href="https://opensource.org/licenses/MIT">MIT</a> license
with the exceptions mentioned in &quot;Third party source code in this repository&quot;.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="install-proxydetox"><a class="header" href="#install-proxydetox">Install Proxydetox</a></h1>
<p>The easiest is, to use the download and install a pre-build package from the
<a href="https://github.com/kiron1/proxydetox/releases/latest" title="Proxydetox releases">releases page</a>.</p>
<p>Pre build binaries are available for the following platforms:</p>
<ul>
<li>Linux</li>
<li>macOS</li>
<li>Windows</li>
</ul>
<h2 id="linux"><a class="header" href="#linux">Linux</a></h2>
<ol>
<li>Download the <a href="https://github.com/kiron1/proxydetox/releases/latest" title="Proxydetox releases"><code>proxydetox-*-x86_64-linux.deb</code></a> Debian package.</li>
<li>Install using the <code>dpkg</code> command from on Debian based platforms:
<pre><code class="language-sh">sudo dpkg --install proxydetox-*-x86_64-linux.deb
</code></pre>
</li>
</ol>
<h3 id="register-proxydetox-as-systemd-user-daemon"><a class="header" href="#register-proxydetox-as-systemd-user-daemon">Register Proxydetox as systemd user daemon</a></h3>
<p>The Debian package comes with systemd service file.</p>
<p>Enabling Proxydetox and starting it, can be done with the following commands:</p>
<pre><code class="language-sh">systemctl --user daemon-reload
systemctl --user enable proxydetox
systemctl --user start proxydetox
</code></pre>
<p>To disable and stop it please use:</p>
<pre><code class="language-sh">systemctl --user stop proxydetox
systemctl --user disable proxydetox
</code></pre>
<h2 id="macos"><a class="header" href="#macos">macOS</a></h2>
<ol>
<li>Download the <a href="https://github.com/kiron1/proxydetox/releases/latest" title="Proxydetox releases"><code>proxydetox-*-x86_64-apple-darwin.pkg</code></a> package.</li>
<li>Install using the <code>installer</code> command from macOS:
<pre><code class="language-sh">sudo installer -package proxydetox-*-x86_64-apple-darwin.pkg -target /
</code></pre>
</li>
</ol>
<h3 id="register-proxydetox-as-launchagent"><a class="header" href="#register-proxydetox-as-launchagent">Register proxydetox as LaunchAgent</a></h3>
<p>The above steps installed a LaunchAgent for proxydetox named
<code>/Library/LaunchAgents/cc.colorto.proxydetox.plist</code>.</p>
<p><strong>Info</strong>: Since the <code>installer</code> command is run as the <code>root</code> user (to be able to write the files to
the system directories) it cannot know for which user the launch agent needs to be enabled.</p>
<p>The following steps need to be executed as the user who wants to use proxydetox (i.e. <em>not</em> as
<em>root</em>).</p>
<pre><code class="language-sh">  launchctl bootstrap &quot;gui/$(id -u)&quot; &quot;/Library/LaunchAgents/cc.colorto.proxydetox.plist&quot;
  launchctl enable &quot;gui/$(id -u)/cc.colorto.proxydetox&quot;
  launchctl print &quot;gui/$(id -u)/cc.colorto.proxydetox&quot;
  launchctl kickstart -kp &quot;gui/$(id -u)/cc.colorto.proxydetox&quot;
</code></pre>
<p>To revert the above changes (i.e. you want to uninstall proxydetox), run the following commands:</p>
<pre><code class="language-sh">  launchctl kill SIGTERM &quot;gui/$(id -u)/cc.colorto.proxydetox&quot;
  launchctl disable &quot;gui/$(id -u)/cc.colorto.proxydetox&quot;
  launchctl bootout &quot;gui/$(id -u)/cc.colorto.proxydetox&quot;
</code></pre>
<h2 id="windows"><a class="header" href="#windows">Windows</a></h2>
<ol>
<li>Download the <a href="https://github.com/kiron1/proxydetox/releases/latest" title="Proxydetox releases"><code>proxydetox-win64.zip</code></a> zip file.</li>
<li>Unzip the archive.</li>
<li>Run the included <a href="https://github.com/kiron1/proxydetox/blob/main/pkg/windows/install.bat" title="install.bat"><code>install.bat</code></a> file.</li>
</ol>
<h2 id="from-sources"><a class="header" href="#from-sources">From sources</a></h2>
<p>To build Proxydetox from sources, please refer the
<a href="./build.html">Build Proxydetox</a> section.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="configuration"><a class="header" href="#configuration">Configuration</a></h1>
<h2 id="file-locations"><a class="header" href="#file-locations">File locations</a></h2>
<p>The following files are read during startup by Proxydetox. These files can be
used to tweak the behaviour of Proxydetox.</p>
<ul>
<li><code>proxydetoxrc</code>: Main configuration file.</li>
<li><code>proxy.pac</code>: The PAC file, which defines the rules to select the correct
upstream proxy.</li>
<li><code>.netrc</code>: Contains the authentication information when <code>--negotiate</code> is <em>not</em>
used.</li>
</ul>
<p>The configuration files are searched at the following locations:</p>
<p>The <code>.netrc</code> file is expected to be located in the <code>HOME</code> directory on all
platforms. If needed, the location can be specified via the <code>--netrc-file</code> flag
when invoking Proxydetox.</p>
<p>The configuration files <code>proxydetoxrc</code> and <code>proxy.pac</code> are searched at user
configurable location and system wide locations.</p>
<p>For the different platforms, the user configurable location is as follows:</p>
<ul>
<li><code>~/.config/proxydetox/</code> (POSIX-compliant systems like <strong>BSD</strong> and <strong>Linux</strong>)</li>
<li><code>~/Library/Application\ Support/proxydetox</code> (<strong>macOS</strong>)</li>
<li><code>%APPDATA%</code> (<strong>Windows</strong>)</li>
</ul>
<p>For the different platforms, the user system wide location is as follows:</p>
<p>POSIX-compliant systems like <strong>BSD</strong>, <strong>macOS</strong>, and <strong>Linux</strong>:</p>
<ul>
<li><code>/usr/etc/proxydetox</code></li>
<li><code>/usr/local/etc/proxydetox/</code></li>
<li><code>/opt/proxydetox/etc/</code></li>
</ul>
<p>Windows:</p>
<ul>
<li><code>.</code> (the directory of the executable)</li>
</ul>
<h2 id="proxydetoxrc-file-format"><a class="header" href="#proxydetoxrc-file-format"><code>proxydetoxrc</code> file format</a></h2>
<p>The <code>proxydetoxrc</code> file lists all options which are usually provided via the
command line to <code>proxydetox</code>.</p>
<h3 id="example"><a class="header" href="#example">Example</a></h3>
<pre><code class="language-sh">proxydeox --negotiate --port 8080 --pac-file http://example.org/proxy.pac
</code></pre>
<p>Is equivalent with a <code>proxydetoxrc</code> file at one of the well known locations
listed above with the following content:</p>
<pre><code>--negotiate
--port 8080
--pac-file http://example.org/proxy.pac
</code></pre>
<h2 id="negotiate-authentication"><a class="header" href="#negotiate-authentication">Negotiate authentication</a></h2>
<p>To enable the Negotiate authentication the <code>--negotiate</code> flag must be added when
calling <code>proxydetox</code> or added to the <code>proxydetoxrc</code> configuration file.</p>
<h2 id="basic-authentication"><a class="header" href="#basic-authentication">Basic authentication</a></h2>
<p>When the basic authentication shall be used (default), the credentials are read
from the <code>~/.netrc</code> file. An example <code>~/.netrc</code> file will look as follows:</p>
<pre><code>machine proxy.example.org
login ProxyUsername
password ProxyPassword
</code></pre>
<p>The basic authentication is insecure, since it required to store the password in
clear text on disk and the password is transferred unencrypted.</p>
<h2 id="proxy-auto-configuration-pac-file"><a class="header" href="#proxy-auto-configuration-pac-file">Proxy Auto-Configuration (PAC) file</a></h2>
<p>A copy of the PAC file <code>proxy.pac</code> must be places in on of directories searched
by Proxydetox or specified via the <code>--pac-file</code> option. The PAC file can be also
a HTTP URL. The content will then be downloaded from the given location.</p>
<p>The PAC file is usually
maintained by the network administrators. The path (usually some http location
in the intranet) can be retrieved from the settings of the pre-configured
internet browser.</p>
<h3 id="examples"><a class="header" href="#examples">Examples</a></h3>
<pre><code>proxydetox --pac-file http://example.org/proxy.pac
</code></pre>
<pre><code>proxydetox --pac-file /tmp/test.pac
</code></pre>
<h2 id="configuration-options"><a class="header" href="#configuration-options">Configuration options</a></h2>
<p>The full list of configuration options can be retrieved with:</p>
<pre><code class="language-sh">proxydetox --help
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="usage"><a class="header" href="#usage">Usage</a></h1>
<p>With Proxydetox running, it is enough for most tools to set the <code>http_proxy</code> and
<code>https_proxy</code> environment variables.</p>
<pre><code class="language-sh">http_proxy=http://127.0.0.1:3128
https_proxy=http://127.0.0.1:3128
no_proxy=127.0.0.1,localhost,::1
export http_proxy https_proxy no_proxy
</code></pre>
<p>To make this changes persistent add them to <code>~/.profile</code>, <code>~/.bashrc</code>, or
<code>~/.zshrc</code> depending on which shell you are using.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="building-proxydetox"><a class="header" href="#building-proxydetox">Building Proxydetox</a></h1>
<p>Proxydetox can be build using <a href="https://doc.rust-lang.org/cargo/" title="Cargo is the Rust package manager">cargo</a> or <a href="https://bazel.build" title="Build and test software of any size, quickly and reliably">Bazel</a>. The macOS
application can only build via Bazel.</p>
<ul>
<li><a href="build.html#using-cargo">Build using <code>cargo</code></a></li>
<li><a href="build.html#using-bazel">Build using <code>bazel</code></a></li>
</ul>
<h2 id="using-cargo"><a class="header" href="#using-cargo">Using cargo</a></h2>
<p>The easiest is, to use <code>cargo</code> from <a href="https://rustup.rs/" title="rustup.rs - The Rust toolchain installer">rustup</a>. The next command will
install the <code>proxydetox</code> binary in <code>~/.cargo/bin</code>.</p>
<pre><code class="language-sh">cargo install --git https://github.com/kiron1/proxydetox.git
</code></pre>
<p>If you have cloned this repository already, you can also do:</p>
<pre><code class="language-sh">cargo install --path .
</code></pre>
<h3 id="enable-build-features"><a class="header" href="#enable-build-features">Enable build features</a></h3>
<p>To enable the Negotiate authentication method, the <code>negotiate</code> feature must be
enabled. This means, we would need to add <code>--features negotiate</code> to the above
<code>cargo install ...</code> command.</p>
<p>On GNU/Linux and macOS the
<a href="https://en.wikipedia.org/wiki/Generic_Security_Services_Application_Program_Interface">Generic Security Services Application Program Interface (GSSAPI)</a> will
be used. On Windows the <a href="https://en.wikipedia.org/wiki/Security_Support_Provider_Interface">Security Support Provider Interface</a> is used .</p>
<h2 id="using-bazel"><a class="header" href="#using-bazel">Using Bazel</a></h2>
<p>The easiest way to obtain Bazel, is by using Bazelisk. The remaining document
assumes that either Bazel is installed and available via the <code>PATH</code> variable or
Bazelisk is installed and the binary is named <code>bazel</code> and available via the
<code>PATH</code> variable.</p>
<p>For the Bazel setup to work, ensue the XCode command line tools are installed:</p>
<pre><code class="language-sh">xcode-select --install
</code></pre>
<h3 id="building-proxydetoxapp-macos-ui"><a class="header" href="#building-proxydetoxapp-macos-ui">Building ProxydetoxApp (macOS UI)</a></h3>
<pre><code class="language-sh">bazel build //macos/app:ProxydetoxApp
</code></pre>
<h3 id="enable-build-features-1"><a class="header" href="#enable-build-features-1">Enable build features</a></h3>
<p>Append <code>--features=negotiate</code> to <code>bazel build</code> to enable the negotiate feature:</p>
<pre><code class="language-sh">bazel build --features=negotiate //...
</code></pre>
<h2 id="autostart"><a class="header" href="#autostart">Autostart</a></h2>
<p>To start Proxydetox automatically when a user is logged in, please see the
<a href="service.html">Autostart</a> section.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="proxydetox-as-user-service"><a class="header" href="#proxydetox-as-user-service">Proxydetox as user service</a></h1>
<p>Register Proxydetox as a user service such that it is automatically started by
the system when the user is logged in.</p>
<p><strong>Note:</strong> This steps are only required when using <code>cargo install</code>. When installing the provided
packages this steps are not necessary.</p>
<h2 id="automatically-start-proxydetox-with-a-user-session"><a class="header" href="#automatically-start-proxydetox-with-a-user-session">Automatically start Proxydetox with a user session</a></h2>
<p>To automatically start <code>proxydetox</code> when an user session is active, we can
register it with <code>systemd(8)</code> on Linux or <code>launchd(8)</code> on macOS.</p>
<h3 id="linux-1"><a class="header" href="#linux-1">Linux</a></h3>
<p>Create a file <code>~/.config/systemd/user/proxydetox.service</code>, you can use
<a href="https://github.com/kiron1/proxydetox/blob/main/debian/proxydetox.service" title="proxydetox.service file"><code>debian/proxydetox.service</code></a> as template, but make sure to update the
<a href="https://man7.org/linux/man-pages/man5/systemd.service.5.html" title="man 5 systemd.service"><code>ExecStart</code></a> part with an <em>absolute</em> path.</p>
<p>To finally enable the service, us the following commands:</p>
<pre><code class="language-sh">systemctl --user daemon-reload
systemctl --user enable proxydetox.service
systemctl --user start proxydetox.service
</code></pre>
<h3 id="macos-1"><a class="header" href="#macos-1">macOS</a></h3>
<p>Create a file <code>~/Library/LaunchAgents/cc.colorto.proxydetox.plist</code>, you can use
<a href="https://github.com/kiron1/proxydetox/blob/main/pkg/macos/cc.colorto.proxydetox.plist" title="proxydetox launchd plist file"><code>cc.colorto.proxydetox.plist</code></a> as template, but make sure to update the
<code>ProgramArguments</code> value with an <em>absolute</em> path.</p>
<p>The following steps need to be executed as the user who wants to use proxydetox (i.e. <em>not</em> as
<em>root</em>).</p>
<pre><code class="language-sh">  launchctl bootstrap &quot;gui/$(id -u)&quot; &quot;/Library/LaunchAgents/cc.colorto.proxydetox.plist&quot;
  launchctl enable &quot;gui/$(id -u)/cc.colorto.proxydetox&quot;
  launchctl print &quot;gui/$(id -u)/cc.colorto.proxydetox&quot;
  launchctl kickstart -kp &quot;gui/$(id -u)/cc.colorto.proxydetox&quot;
</code></pre>
<p>To revert the above changes (i.e. you want to uninstall proxydetox), run the following commands:</p>
<pre><code class="language-sh">  launchctl kill SIGTERM &quot;gui/$(id -u)/cc.colorto.proxydetox&quot;
  launchctl disable &quot;gui/$(id -u)/cc.colorto.proxydetox&quot;
  launchctl bootout &quot;gui/$(id -u)/cc.colorto.proxydetox&quot;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rust-toolchain"><a class="header" href="#rust-toolchain">Rust Toolchain</a></h1>
<pre><code class="language-sh">rustup target add x86_64-pc-windows-gnu
rustup toolchain install stable-x86_64-pc-windows-gnu
</code></pre>
<h1 id="c-toolchain"><a class="header" href="#c-toolchain">C Toolchain</a></h1>
<p>We can use <a href="https://pkgsrc.joyent.com/install-on-osx/">pkgsrc</a> to
install the the mingw GNU cross compiler:</p>
<pre><code class="language-sh">sudo pkgin install mingw-w64-x86_64-gcc mingw-w64-x86_64-winpthreads-8.0.0
</code></pre>
<h1 id="buildrs-of-duktape-sys"><a class="header" href="#buildrs-of-duktape-sys">build.rs of duktape-sys</a></h1>
<h2 id="bindgen"><a class="header" href="#bindgen">bindgen</a></h2>
<p>Help <code>bindgen</code> to pick up the right header files:</p>
<pre><code class="language-sh">export BINDGEN_EXTRA_CLANG_ARGS=&quot;--sysroot /opt/pkg/cross/x86_64-w64-mingw32/mingw/&quot;
</code></pre>
<h2 id="cc"><a class="header" href="#cc">cc</a></h2>
<p>Help <code>cc</code> to find the right cross compiler:</p>
<pre><code class="language-sh">export CC=/opt/pkg/cross/x86_64-w64-mingw32/bin/x86_64-w64-mingw32-gcc
export CROSS_COMPILE=x86_64-w64-mingw32-gcc-
</code></pre>
<p>The <a href="https://github.com/alexcrichton/cc-rs/blob/master/src/lib.rs#L2347"><code>CROSS_COMPILE</code></a>
variable is used in the <code>cc</code> crate.</p>
<h1 id="cargo-configuration"><a class="header" href="#cargo-configuration">Cargo configuration</a></h1>
<p>File <code>~/.cargo/config.toml</code>:</p>
<pre><code class="language-toml">[target.x86_64-pc-windows-gnu]
linker = &quot;/opt/pkg/cross/x86_64-w64-mingw32/bin/x86_64-w64-mingw32-gcc&quot;
rustc-link-search = [&quot;/opt/pkg/cross/x86_64-w64-mingw32-winpthreads/mingw//lib/&quot;]
</code></pre>
<h1 id="cross-compile"><a class="header" href="#cross-compile">Cross compile</a></h1>
<pre><code class="language-sh">export RUSTFLAGS=&quot;-L /opt/pkg/cross/x86_64-w64-mingw32-winpthreads/mingw/lib&quot;
cargo build --target x86_64-pc-windows-gnu
</code></pre>
<h1 id="reference"><a class="header" href="#reference">Reference</a></h1>
<ul>
<li>https://doc.rust-lang.org/cargo/reference/config.html</li>
<li>https://doc.rust-lang.org/cargo/reference/config.html#targettriplelinker</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="for-developers"><a class="header" href="#for-developers">For Developers</a></h1>
<h2 id="components-in-this-repository"><a class="header" href="#components-in-this-repository">Components in this repository</a></h2>
<h3 id="javascript-support"><a class="header" href="#javascript-support">JavaScript support</a></h3>
<p>Since the PAC files are actual JavaScript code, Proxydetox needs to be able to
run JavaScript code.</p>
<ul>
<li><a href="./duktape-sys/">duktape-sys</a> - FFI bindings for Rust of the
<a href="https://duktape.org">duktape</a> JavaScript interpreter library written in C.</li>
<li><a href="./duktape/">duktape</a> - Idiomatic Rust wrapper for the <code>duktape_sys</code> crate.
(Just enough which is needed in this product context).</li>
</ul>
<h3 id="evaluation-of-pac-scripts"><a class="header" href="#evaluation-of-pac-scripts">Evaluation of PAC scripts</a></h3>
<ul>
<li><a href="./paclib/">paclib</a> - Functions needed to implement <code>FindProxyForURL</code> and wrap
it in Rust.</li>
<li><a href="./paceval/">paceval</a> - A utility to evaluate PAC files for a given URL and
print the result.</li>
</ul>
<h3 id="http-proxy-code"><a class="header" href="#http-proxy-code">HTTP Proxy code</a></h3>
<ul>
<li><a href="./proxy_client/">proxy_client</a> - Supporting code to allow <a href="https://github.com/hyperium/hyper" title="A fast and correct HTTP implementation for Rust"><code>hyper</code></a> to
utilize HTTP proxies.</li>
<li><a href="./proxydetox/">proxydetox</a> - The actual Proxydetox software.</li>
</ul>
<h2 id="third-party-source-code-in-this-repository"><a class="header" href="#third-party-source-code-in-this-repository">Third party source code in this repository</a></h2>
<ul>
<li><a href="duktape-sys/src/duk_config.h">duk_config.h</a>,
<a href="duktape-sys/src/duktape.h">duktape.h</a>, and
<a href="duktape-sys/src/duktape.c">duktape.c</a> are from the
<a href="https://duktape.org">Duktape project</a> and is under the MIT license.</li>
<li><a href="paclib/src/pac_utils.js">pac_utils.js</a> is extracted from
<a href="https://dxr.mozilla.org/mozilla-central/source/netwerk/base/ProxyAutoConfig.cpp">Mozillas ProxyAutoConfig.cpp</a>
and is under the MPL2 license.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="alternative-solutions"><a class="header" href="#alternative-solutions">Alternative solutions</a></h1>
<ul>
<li><a href="http://www.squid-cache.org" title="A caching proxy for the Web">Squid</a>: using the <a href="http://www.squid-cache.org/Doc/config/cache_peer/" title="Squid configuration directive cache_peer">cache_peer</a> directive and translating
the given PAC file into Squid ACLs.</li>
<li><a href="https://github.com/zhuhaow/SpechtLite" title="A rule-based proxy for macOS">SpechtLite</a>: and translating the PAC file into the SpechtLite YAML
configuration format (<strong>unmaintained</strong>).</li>
<li><a href="https://github.com/genotrance/px" title="Px">Px</a>: A HTTP proxy server to automatically authenticate through an NTLM
proxy (can handle PAC files). Written in Python and focus more on Windows machines.</li>
<li><a href="http://cntlm.sf.net/" title="Cntlm Authentication Proxy">Cntlm</a>: a NTLM / NTLMv2 authenticating HTTP/1.1 proxy. Cannot handle
PAC files (<strong>unmaintained</strong>).</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </body>
</html>
